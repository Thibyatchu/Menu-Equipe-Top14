<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <title>Équipes Top 14 - Accueil</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="styles.css" rel="stylesheet"> <!-- Référence au fichier CSS externe -->
</head>

<body class="text-center d-flex align-items-center cover-container">
    <div class="cover-container mx-auto">
        <main role="main" class="inner cover">
            <h1 class="cover-heading">Bienvenue dans l'application Équipes Top 14</h1>
            <p class="lead">Grâce à cette application vous pourrez :</p>
            <ul class="lead text-left">
                <li>Voir toutes les équipes du Top 14</li>
                <li>Ajouter des équipes</li>
                <li>Modifier des équipes</li>
                <li>Supprimer des équipes</li>
                <li>Effectuer les mêmes actions pour les joueurs !</li>
            </ul>
            <div class="mt-4">
                <button id="check-connection" class="btn btn-lg btn-secondary mr-2">Vérifier la connexion</button>
                <button id="go-to-http-page" class="btn btn-lg btn-primary">Aller sur la page des requêtes</button>
            </div>
            <div id="status-message" class="mt-3"></div>
        </main>
    </div>


    <script>
        var token = ''; // Variable globale pour stocker le token

        // Fonction pour vérifier la connexion à l'API
        $('#check-connection').click(function () {
            var formData = new FormData();
            formData.append("user", "Thib");
            formData.append("password", "Equipe14");

            $.ajax({
                url: 'https://localhost:7162/Auth',
                type: 'POST',
                headers: {
                    'accept': '*/*'
                },
                data: formData,
                processData: false,
                contentType: false,
                success: function (response) {
                    console.log('Connexion réussie:', response);
                    showStatusMessage('Connexion établie avec succès.', 'success');
                    token = response.token; // Assurez-vous que la réponse contient le token
                    // Stocker le token dans sessionStorage ou localStorage si nécessaire
                    sessionStorage.setItem('token', token); // Exemple avec sessionStorage
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    console.error('Erreur de connexion:', textStatus, errorThrown);
                    showStatusMessage('Erreur lors de la connexion à l\'API.', 'error');
                }
            });
        });

        // Fonction pour afficher le message de statut
        function showStatusMessage(message, type) {
            $('#status-message').removeClass().addClass(type).text(message);
        }


        // Action du bouton "Aller sur la page HTTP"
        $('#go-to-http-page').click(function () {
            // Redirection vers une autre page où seront gérées les autres requêtes HTTP
            window.location.href = 'requete_http.html';
        });
    </script>
</body>

</html>
