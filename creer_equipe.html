<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <title>Créer une équipe</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="styles.css" rel="stylesheet">
</head>

<body class="container py-4">

    <div class="text-center mb-4">
        <h1>Créer une nouvelle équipe</h1>
    </div>

    <form id="create-team-form">
        <div class="form-group">
            <label for="team-name">Nom de l'équipe</label>
            <input type="text" class="form-control" id="team-name" required>
        </div>
        <div class="form-group">
            <label for="team-city">Ville de l'équipe</label>
            <input type="text" class="form-control" id="team-city" required>
        </div>
        <button type="submit" class="btn btn-success">Créer l'équipe</button>
        <button type="button" class="btn btn-primary ml-2" onclick="window.location.href='requete_equipe.html'">retourner voir les équipes</button>
    </form>

    <div id="status-message" class="mt-3"></div>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        $('#create-team-form').submit(function (event) {
            event.preventDefault();

            var teamName = $('#team-name').val();
            var teamCity = $('#team-city').val();
            var token = sessionStorage.getItem('token');

            var newTeam = {
                id: 0,
                name: teamName,
                ville: teamCity,
                joueurs: []
            };

            $.ajax({
                url: 'https://localhost:7162/Equipe',
                type: 'POST',
                headers: {
                    'Accept': '*/*',
                    'Authorization': 'Bearer ' + token,
                    'Content-Type': 'application/json'
                },
                data: JSON.stringify(newTeam),
                success: function (response) {
                    console.log('Équipe créée avec succès:', response);
                    $('#status-message').html('<div class="alert alert-success" role="alert">Équipe créée avec succès.</div>');
                    $('#team-name').val('');
                    $('#team-city').val('');
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    console.error('Erreur lors de la création de l\'équipe:', textStatus, errorThrown);
                    $('#status-message').html('<div class="alert alert-danger" role="alert">Erreur lors de la création de l\'équipe.</div>');
                }
            });
        });
    </script>
</body>
</html>
